local httpService = game:GetService("HttpService")

-- Fetch Key from URL
local keyURL = "http://sfcdays.unaux.com/key.txt"
local correctKey = nil

local success, response = pcall(function()
    return game:HttpGet(keyURL)
end)

if success then
    correctKey = response:gsub("%s+", "") -- Trim whitespace
else
    warn("Failed to fetch key!")
    return
end

-- Create Screen GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "KeySystem"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Create Background Blur
local blurEffect = Instance.new("BlurEffect")
blurEffect.Size = 10
blurEffect.Parent = game.Lighting

-- Create Key UI Frame
local keyFrame = Instance.new("Frame")
keyFrame.Size = UDim2.new(0, 250, 0, 130)
keyFrame.Position = UDim2.new(0.5, -125, 0.4, -65)
keyFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
keyFrame.BorderSizePixel = 0
keyFrame.Parent = screenGui

local keyTitle = Instance.new("TextLabel")
keyTitle.Size = UDim2.new(1, 0, 0, 30)
keyTitle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
keyTitle.Text = "Enter Key"
keyTitle.Font = Enum.Font.Gotham -- Using the same font as Key UI
keyTitle.TextSize = 20
keyTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
keyTitle.Parent = keyFrame

local keyInput = Instance.new("TextBox")
keyInput.Size = UDim2.new(0.8, 0, 0, 35)
keyInput.Position = UDim2.new(0.1, 0, 0.35, 0)
keyInput.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
keyInput.Text = "Enter Key..."
keyInput.Font = Enum.Font.Gotham
keyInput.TextSize = 16
keyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
keyInput.Parent = keyFrame

local submitKeyButton = Instance.new("TextButton")
submitKeyButton.Size = UDim2.new(0.8, 0, 0, 35)
submitKeyButton.Position = UDim2.new(0.1, 0, 0.65, 0)
submitKeyButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
submitKeyButton.Text = "Submit"
submitKeyButton.Font = Enum.Font.Gotham
submitKeyButton.TextSize = 16
submitKeyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
submitKeyButton.Parent = keyFrame

-- Function to create the Music Player UI
local function createMusicPlayer()
    keyFrame.Visible = false
    blurEffect:Destroy()

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 350, 0, 250)
    frame.Position = UDim2.new(0.5, -175, 0.4, -125)
    frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    frame.Parent = screenGui

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 40)
    title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    title.Text = "Music Player"
    title.Font = Enum.Font.Gotham
    title.TextSize = 20
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.Parent = frame

    local songInput = Instance.new("TextBox")
    songInput.Size = UDim2.new(0.8, 0, 0, 40)
    songInput.Position = UDim2.new(0.1, 0, 0.3, 0)
    songInput.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    songInput.Text = "Enter Song ID..."
    songInput.Font = Enum.Font.Gotham
    songInput.TextSize = 16
    songInput.TextColor3 = Color3.fromRGB(255, 255, 255)
    songInput.Parent = frame

    local playButton = Instance.new("TextButton")
    playButton.Size = UDim2.new(0.8, 0, 0, 40)
    playButton.Position = UDim2.new(0.1, 0, 0.55, 0)
    playButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
    playButton.Text = "Play"
    playButton.Font = Enum.Font.Gotham
    playButton.TextSize = 16
    playButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    playButton.Parent = frame

    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0.15, 0, 0.2, 0)
    closeButton.Position = UDim2.new(0.82, 0, 0, 5)
    closeButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    closeButton.Text = "X"
    closeButton.Font = Enum.Font.Gotham
    closeButton.TextSize = 18
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.Parent = frame

    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Size = UDim2.new(0.15, 0, 0.2, 0)
    minimizeButton.Position = UDim2.new(0.65, 0, 0, 5)
    minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 170, 0)
    minimizeButton.Text = "-"
    minimizeButton.Font = Enum.Font.Gotham
    minimizeButton.TextSize = 18
    minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    minimizeButton.Parent = frame

    local sound = Instance.new("Sound")
    sound.Parent = game.Workspace
    sound.Looped = true

    local openButton = Instance.new("TextButton")
    openButton.Size = UDim2.new(0, 100, 0, 40)
    openButton.Position = UDim2.new(1, -110, 0, 10)
    openButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    openButton.Text = "Open"
    openButton.Font = Enum.Font.Gotham
    openButton.TextSize = 16
    openButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    openButton.Parent = screenGui
    openButton.Visible = false

    playButton.MouseButton1Click:Connect(function()
        local songId = songInput.Text
        if tonumber(songId) then
            sound.SoundId = "rbxassetid://" .. songId
            sound:Play()
        end
    end)

    closeButton.MouseButton1Click:Connect(function()
        sound:Stop()
        screenGui:Destroy()
    end)

    minimizeButton.MouseButton1Click:Connect(function()
        frame.Visible = false
        openButton.Visible = true
    end)

    openButton.MouseButton1Click:Connect(function()
        frame.Visible = true
        openButton.Visible = false
    end)
end

-- Key Submission Function
submitKeyButton.MouseButton1Click:Connect(function()
    local enteredKey = keyInput.Text:gsub("%s+", "")
    if enteredKey == correctKey then
        createMusicPlayer()
    else
        keyTitle.Text = "Invalid Key!"
        keyTitle.TextColor3 = Color3.fromRGB(255, 0, 0)
        wait(2)
        keyTitle.Text = "Enter Key"
        keyTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    end
end)